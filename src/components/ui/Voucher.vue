<script setup>
import { useCouponStore } from '@/stores/voucher.js'

const voucher = useCouponStore()
</script>

<template>
  <form
      class="space-y-4"
      @submit.prevent
  >
      <label for="voucher" class="mb-2 block text-sm font-medium text-gray-900">Do you have a discount code?</label>
      <div class="relative">
        <div class="absolute inset-y-0 start-0 flex items-center ps-3 pr-5 pointer-events-none">
          <svg fill="none" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g id="Voucher"><path clip-rule="evenodd" d="M0.25 7C0.25 6.0335 1.0335 5.25 2 5.25H22C22.9665 5.25 23.75 6.0335 23.75 7V9C23.75 9.41421 23.4142 9.75 23 9.75C22.5858 9.75 22.25 9.41421 22.25 9V7C22.25 6.86193 22.1381 6.75 22 6.75H2C1.86193 6.75 1.75 6.86193 1.75 7V9C1.75 9.41421 1.41421 9.75 1 9.75C0.585786 9.75 0.25 9.41421 0.25 9V7ZM1 15.25C1.41421 15.25 1.75 15.5858 1.75 16V18C1.75 18.1381 1.86193 18.25 2 18.25H22C22.1381 18.25 22.25 18.1381 22.25 18V16C22.25 15.5858 22.5858 15.25 23 15.25C23.4142 15.25 23.75 15.5858 23.75 16V18C23.75 18.9665 22.9665 19.75 22 19.75H2C1.0335 19.75 0.25 18.9665 0.25 18V16C0.25 15.5858 0.585786 15.25 1 15.25Z" fill="black" fill-rule="evenodd" id="Rectangle 23 (Stroke)"/><path clip-rule="evenodd" d="M22.5 9.75C20.9812 9.75 19.75 10.9812 19.75 12.5C19.75 14.0188 20.9812 15.25 22.5 15.25C22.9142 15.25 23.25 15.5858 23.25 16C23.25 16.4142 22.9142 16.75 22.5 16.75C20.1528 16.75 18.25 14.8472 18.25 12.5C18.25 10.1528 20.1528 8.25 22.5 8.25C22.9142 8.25 23.25 8.58579 23.25 9C23.25 9.41421 22.9142 9.75 22.5 9.75Z" fill="black" fill-rule="evenodd" id="Ellipse 10 (Stroke)"/><path clip-rule="evenodd" d="M0.25 9C0.25 8.58579 0.585786 8.25 1 8.25C3.34721 8.25 5.25 10.1528 5.25 12.5C5.25 14.8472 3.34721 16.75 1 16.75C0.585786 16.75 0.25 16.4142 0.25 16C0.25 15.5858 0.585786 15.25 1 15.25C2.51878 15.25 3.75 14.0188 3.75 12.5C3.75 10.9812 2.51878 9.75 1 9.75C0.585786 9.75 0.25 9.41421 0.25 9Z" fill="black" fill-rule="evenodd" id="Ellipse 11 (Stroke)"/><path clip-rule="evenodd" d="M9 17.25C9.41421 17.25 9.75 17.5858 9.75 18V19C9.75 19.4142 9.41421 19.75 9 19.75C8.58579 19.75 8.25 19.4142 8.25 19V18C8.25 17.5858 8.58579 17.25 9 17.25Z" fill="black" fill-rule="evenodd" id="Vector 28 (Stroke)"/><path clip-rule="evenodd" d="M9 13.25C9.41421 13.25 9.75 13.5858 9.75 14V15C9.75 15.4142 9.41421 15.75 9 15.75C8.58579 15.75 8.25 15.4142 8.25 15V14C8.25 13.5858 8.58579 13.25 9 13.25Z" fill="black" fill-rule="evenodd" id="Vector 29 (Stroke)"/><path clip-rule="evenodd" d="M9 9.25C9.41421 9.25 9.75 9.58579 9.75 10V11C9.75 11.4142 9.41421 11.75 9 11.75C8.58579 11.75 8.25 11.4142 8.25 11V10C8.25 9.58579 8.58579 9.25 9 9.25Z" fill="black" fill-rule="evenodd" id="Vector 30 (Stroke)"/><path clip-rule="evenodd" d="M9 5.25C9.41421 5.25 9.75 5.58579 9.75 6V7C9.75 7.41421 9.41421 7.75 9 7.75C8.58579 7.75 8.25 7.41421 8.25 7V6C8.25 5.58579 8.58579 5.25 9 5.25Z" fill="black" fill-rule="evenodd" id="Vector 31 (Stroke)"/></g></svg>
        </div>
        <input
            type="text"
            class="block w-full p-4 ps-10 text-md font-semibold text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:bg-gray-100 focus:ring-teal-500 focus:border-teal-500"
            placeholder="Enter code..."
            required
            v-model="voucher.couponInput"
        />
        <button
            type="submit"
            class="text-white absolute end-2.5 bottom-2.5 bg-teal-700 hover:bg-teal-800 focus:ring-4 focus:outline-none focus:ring-teal-300 font-medium rounded-lg text-sm px-4 py-2 disabled:bg-gray-200"
            @click="voucher.applyCoupon"
            :disabled="voucher.isValidCoupon"
        >
          Apply
        </button>
      </div>
    <div
        v-if="voucher.couponValidationMessage !== ''"
        class="mt-5 rounded-lg border border-ld shadow border-teal-600 p-4 uppercase bg-teal-50"
    >
      <p class="py-2 text-center text-sm font-extrabold">
        {{ voucher.couponValidationMessage }}
      </p>
    </div>
  </form>
</template>
